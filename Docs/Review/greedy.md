[TOC]
# 贪心算法
## 核心
- 每一步直接选当前的最优决定, 不管由此产生的子问题
## 证明
- 证明最优子结构的性质, **即任何一个大问题的最优解由小问题的最优解构成**
  - 保证贪心选择可以一直地循环进行
- 证明贪心选择的性质, **即通过贪心地求解子问题, 能够得到全局最优解/最优解之一**
  - **方法: 给出使用贪心策略得到的解的形式, 然后对于任意一个最优解, 将最优解通过一系列方法转换成贪心解的形式, 并且证明转换后的解仍是最优解。**
## 小数背包问题
### 证明
![](../../Resources/7%20贪心算法_页面_1.png)
![](../../Resources/7%20贪心算法_页面_2.png)
### 复杂度
- 时间复杂度$O(n\lg n)$
## 霍夫曼编码
### 证明
![](../../Resources/7%20贪心算法_页面_3.png)
![](../../Resources/7%20贪心算法_页面_4.png)
![](../../Resources/7%20贪心算法_页面_5.png)
### 复杂度
- 时间复杂度$O(n\lg n)$
- 空间复杂度$O(n)$

## 找钱问题
### 证明
- **最优子结构**
  - 对$A$分钱的最优找钱解$X=\{x_1,\cdots,x_n\}$, 若$x_i=1$, 则令$Z = X_{1:i-1}\cup {0}\cup X_{i+1:n}$, 则$Z$是$A-v_i$的最优找钱解。否则, 假设存在$Z'$是$A-v_i$的最优解, 那么令$z_i = z_i+1$, 得$X'$, 则$\sum x_i = \sum z_i + 1 > \sum z_i' + 1 = \sum x_i'$, 与$X$是$A$的最优解矛盾。
- **贪心选择性质**
  - 首先不妨设$x_i$对应面值第$i$**大**的硬币, 对于任意一个最优解$Z = \{z_1,\cdots,z_n\}$, 将其改造为$X=\{1,1,\cdots,1,x_k,0,0,\cdots,0\}$的形式, 证明该形式下的解是一个最优解。
  - **证明:** 
    - 首先假设从第$j$位起有$z_j\ne x_j$, 则一定有$z_j \leq x_j-1$, 否则和小数背包一样, 会导致$\sum v_iz_i > A$; 
    - 于是考虑将$z_j$扩充为$x_j$, 则有$Z'=X_{1:j}\cup Z'_{j+1:n}$, 其中$Z_{j+1:n}'$中减少了一部分硬币的数量, 使得减少的总金额$\psi = v_j*(x_j - z_j) = \sum_{i=j+1}^n v_iz_i - \sum_{i=j+1}^n v_iz_i'$
    - 因为$v_{j+1}\ge v_{j+2} $, 所以减少的硬币数至少是$\lceil\frac{\psi}{v_{j+1}}\rceil$, 于是有$$\begin{aligned}
      \sum_{i=j+1}^n z_i' &\le \sum_{i=j+1}^n z_i - \lceil\frac{\psi}{v_{j+1}}\rceil \le  \sum_{i=j+1}^n z_i - \frac{\psi}{v_{j+1}}  \\
      \implies \sum_{i=1}^n z_i' &= \sum_{i=1}^j z_i + \sum_{i=j+1}^n z_i' + x_j\\
        &\leq \sum_{i=1}^j z_i + \sum_{i=j+1}^n z_i - \frac{\psi}{v_{j+1}} + x_j\\
        &= \sum_{i=1}^n z_i + x_j - z_j - \frac{\psi}{v_{j+1}}\\
        &= \sum_{i=1}^nz_i + \frac{\psi}{v_j} - \frac{\psi}{v_{j+1}}\\
        &\leq \sum_{i=1}^nz_i
    \end{aligned}
    $$
    由此, $\sum z_i'$一定是一个最优解, 贪心选择性质得证。 
### 复杂度
- 时间复杂度$O(n\lg n)$
- 空间复杂度$O(n)$